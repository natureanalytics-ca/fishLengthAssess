<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Utility functions | fishLengthAssess R package</title>
  <meta name="description" content="This document includes the description of fishLengthAssess R package." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Utility functions | fishLengthAssess R package" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This document includes the description of fishLengthAssess R package." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Utility functions | fishLengthAssess R package" />
  
  <meta name="twitter:description" content="This document includes the description of fishLengthAssess R package." />
  

<meta name="author" content="William Harford" />


<meta name="date" content="2025-02-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-based-functions.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">fishLengthAssess R package</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> What is fishLengthAssess?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-use-fishlengthassess"><i class="fa fa-check"></i><b>1.2</b> How to use fishLengthAssess?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-objects-and-example-data-sets.html"><a href="r-objects-and-example-data-sets.html"><i class="fa fa-check"></i><b>2</b> R objects and example data sets</a></li>
<li class="chapter" data-level="3" data-path="indicator-based-functions.html"><a href="indicator-based-functions.html"><i class="fa fa-check"></i><b>3</b> Indicator-based functions</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="indicator-based-functions.html"><a href="indicator-based-functions.html#pmatfunc-function"><i class="fa fa-check"></i><b>3.0.1</b> <code>PmatFunc</code> function</a></li>
<li class="chapter" data-level="3.0.2" data-path="indicator-based-functions.html"><a href="indicator-based-functions.html#poptfunc-function"><i class="fa fa-check"></i><b>3.0.2</b> <code>PoptFunc</code> function</a></li>
<li class="chapter" data-level="3.0.3" data-path="indicator-based-functions.html"><a href="indicator-based-functions.html#pmegafunc-function"><i class="fa fa-check"></i><b>3.0.3</b> <code>PmegaFunc</code> function</a></li>
<li class="chapter" data-level="3.0.4" data-path="indicator-based-functions.html"><a href="indicator-based-functions.html#plcfunc-function"><i class="fa fa-check"></i><b>3.0.4</b> <code>PLcFunc</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="model-based-functions.html"><a href="model-based-functions.html"><i class="fa fa-check"></i><b>4</b> Model-based functions</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="model-based-functions.html"><a href="model-based-functions.html#lbsprwrapper-function"><i class="fa fa-check"></i><b>4.0.1</b> <code>lbsprWrapper</code> function</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="utility-functions.html"><a href="utility-functions.html"><i class="fa fa-check"></i><b>5</b> Utility functions</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="utility-functions.html"><a href="utility-functions.html#poollengthcomp-function"><i class="fa fa-check"></i><b>5.0.1</b> <code>poolLengthComp</code> function</a></li>
<li class="chapter" data-level="5.0.2" data-path="utility-functions.html"><a href="utility-functions.html#loptfunc-function"><i class="fa fa-check"></i><b>5.0.2</b> <code>LoptFunc</code> function</a></li>
<li class="chapter" data-level="5.0.3" data-path="utility-functions.html"><a href="utility-functions.html#lcfunc-function"><i class="fa fa-check"></i><b>5.0.3</b> <code>LcFunc</code> function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">fishLengthAssess R package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="utility-functions" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Utility functions<a href="utility-functions.html#utility-functions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="poollengthcomp-function" class="section level3 hasAnchor" number="5.0.1">
<h3><span class="header-section-number">5.0.1</span> <code>poolLengthComp</code> function<a href="utility-functions.html#poollengthcomp-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>poolLengthComp</code> function pools length data when multiple columns exist. It sums length frequency data or concatenates length composition data as a single vector.</p>
</div>
<div id="loptfunc-function" class="section level3 hasAnchor" number="5.0.2">
<h3><span class="header-section-number">5.0.2</span> <code>LoptFunc</code> function<a href="utility-functions.html#loptfunc-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>LoptFunc</code> function calculates optimum harvest length. Derived from Beverton 1992, in a year-class subject to a moderate and constant exponential mortality and whose individuals are growing towards an asymptotic size (as in the Von Bertalanffy growth function), the total biomass of the year-class (i.e.Â the product of numbers and average weight) reaches a maximum value at some intermediate age (<span class="math inline">\(Topt\)</span>) at a certain weight and length of the individual fish (<span class="math inline">\(Wopt\)</span> and <span class="math inline">\(Lopt\)</span>, respectively). <span class="math inline">\(Lopt\)</span> is calculated as:</p>
<p><span class="math display">\[
Lopt = 3 \frac {L_{\infty}}{(3 + M/K)}
\]</span>
This function is necessary for the <code>PoptFunc</code> function (proportion of fish within optimal sizes in the catch).</p>
</div>
<div id="lcfunc-function" class="section level3 hasAnchor" number="5.0.3">
<h3><span class="header-section-number">5.0.3</span> <code>LcFunc</code> function<a href="utility-functions.html#lcfunc-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>LcFunc</code> estimates length at full selectivity. This can be done in two methods: 1) using the mode of the length-frequency distribution (LFD); or 2) applying a Kernel smoother to the LFD. For calculating the mode of the LFD, the cumulative distribution of the LFD is computed, and a loess smoother is applied to predict across equally spaced length intervals (1 cm interval); the length at which the cumulative distribution of the predictions increases the most (highest slope) corresponds to the mode of the LFD. Figure 1 shows the cumulative distribution of an example predicted LFD, and the vertical line corresponds to the mode of the distribution.</p>
<div class="figure"><span style="display:block;" id="fig:cumulative-distribution-plot"></span>
<img src="_main_files/figure-html/cumulative-distribution-plot-1.png" alt="Cumulative length-frequency distribution" width="672" />
<p class="caption">
Figure 5.1: Cumulative length-frequency distribution
</p>
</div>
<p>The second method is to apply a Kernel smoother to the LFD and take its maximum value as the length at full selectivity. Figure 2 shows the length at which the Kernel smoother estimates highest density estimates.</p>
<div class="figure"><span style="display:block;" id="fig:kernel-smoother-plot"></span>
<img src="_main_files/figure-html/kernel-smoother-plot-1.png" alt="Kernel smoother applied to length-frequency distribution" width="672" />
<p class="caption">
Figure 5.2: Kernel smoother applied to length-frequency distribution
</p>
</div>
<p>Some results from applying these two functions to example LFDs are presented below. The left-hand plots show an example LFD, and the right-hand side plots show a subset of the example LFD, in order to test the functions with smaller sample sizes and more sparse data.</p>
<div class="figure"><span style="display:block;" id="fig:results1"></span>
<img src="_main_files/figure-html/results1-1.png" alt="Example LFD 2019" width="672" />
<p class="caption">
Figure 5.3: Example LFD 2019
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:results2"></span>
<img src="_main_files/figure-html/results2-1.png" alt="Example LFD 2018" width="672" />
<p class="caption">
Figure 5.4: Example LFD 2018
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:results3"></span>
<img src="_main_files/figure-html/results3-1.png" alt="Example LFD 2015" width="672" />
<p class="caption">
Figure 5.5: Example LFD 2015
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:results4"></span>
<img src="_main_files/figure-html/results4-1.png" alt="Example LFD 2017" width="672" />
<p class="caption">
Figure 5.6: Example LFD 2017
</p>
</div>
<p>These results show that for relatively complete LFDs (higher sample size, left-hand plots), the two methods (mode of LFD and kernel smoother) estimate similar lengths at full selectivity <code>Lc</code>. However, for more sparse length data (right-hand plots), the mode of the LFD might give very different results as for the example LFDs for 2019 and 2017. This is because the highest slope of the cumulative distribution occurred at smaller lengths. The kernel smoother seems to give more stable/reliable estimates of length at full selectivity.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-based-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-utilities.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
