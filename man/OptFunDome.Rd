% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gtg_dome_lbspr.R
\name{OptFunDome}
\alias{OptFunDome}
\title{Optimization Objective Function for Dome-Shaped Selectivity}
\usage{
OptFunDome(
  tryFleetPars,
  fixedFleetPars,
  LenDat,
  lifeHistoryObj,
  SizeBins = NULL,
  mod = c("GTG", "LBSPR")
)
}
\arguments{
\item{tryFleetPars}{Numeric vector of parameters to optimize (typically log(F/M)
and optionally selectivity parameters)}

\item{fixedFleetPars}{List of fixed fleet parameters including selectivity type
and other non-optimized selectivity parameters (i.e., dome-shaped selectivity)}

\item{LenDat}{Numeric vector of observed length composition data}

\item{lifeHistoryObj}{S4 life history object (same format as GTGDomeLBSPRSim2)}

\item{SizeBins}{Optional list of size bin specifications}

\item{mod}{Character string specifying model type ("GTG" or "LBSPR")}
}
\value{
Negative log-likelihood value (including penalties if applicable)
}
\description{
Objective function for optimizing fishing mortality and optionally logistic selectivity parameters by comparing predicted vs observed length compositions.
}
\details{
This function serves as the objective function for optimization routines.
It calls the GTGDomeLBSPRSim2 simulation with trial parameters, compares predicted length
composition to observed data using multinomial likelihood, and returns the
negative log-likelihood.

For logistic selectivity estimation, it includes penalty functions to prevent
biologically unreasonable parameter estimates (e.g., SL50 too close to Linf).
}
\examples{
# example code
 # Create LifeHistory object
LifeHistoryObj <- new("LifeHistory")
LifeHistoryObj@Linf <- 120
LifeHistoryObj@K <- 0.2
LifeHistoryObj@L50 <- 60
LifeHistoryObj@L95delta <- 2
LifeHistoryObj@MK <- 1.5
LifeHistoryObj@LW_A <- 0.01
LifeHistoryObj@LW_B <- 3
LifeHistoryObj@Steep <- 0.7
LifeHistoryObj@R0 <- 1E6
attr(LifeHistoryObj, "NGTG") <- 13
attr(LifeHistoryObj, "CVLinf") <- 0.1
attr(LifeHistoryObj, "MaxSD") <- 2

# Fixed dome-shaped selectivity parameters
fixedFleetPars <- list(
selectivityCurve = "Normal.sca",
SL1 = 55,
SL2 = 18,
SLmesh = c(13.5, 14.0, 14.8, 15.4, 15.9, 16.6, 17.8, 19),
use_aggregated = TRUE
)

# Trial parameter (log F/M)
tryFleetPars <- c(0.5)  # corresponds to F/M = exp(0.5) = 1.65
# Simulated observed data
data(gtg_catch_frequency)
LenDat <- gtg_catch_frequency$Catch_1
# Calculate negative log-likelihood
nll <- OptFunDome(tryFleetPars, fixedFleetPars, LenDat, LifeHistoryObj, 
                 SizeBins = list(Linc = 1, ToSize = 144), mod = "GTG")
print(nll)                
}
\seealso{
\code{\link{DoOptDome}}, \code{\link{GTGDomeLBSPRSim2}}
}
\keyword{internal}
