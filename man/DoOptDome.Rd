% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gtg_dome_lbspr.R
\name{DoOptDome}
\alias{DoOptDome}
\title{Optimize Dome-Shaped Selectivity Parameters}
\usage{
DoOptDome(
  lifeHistoryObj,
  fixedFleetPars,
  LenDat,
  SizeBins = NULL,
  mod = c("GTG", "LBSPR")
)
}
\arguments{
\item{lifeHistoryObj}{S4 life history object (same format as GTGDomeLBSPRSim2)}

\item{fixedFleetPars}{List of fleet parameters including selectivity type.
If only selectivity type is provided for logistic selectivity, SL50 and SL95 will be estimated}

\item{LenDat}{Numeric vector of observed length composition (catch numbers by length)}

\item{SizeBins}{Optional list of size bin specifications}

\item{mod}{Character string specifying model type ("GTG" or "LBSPR").
Currently only "GTG" is supported}
}
\value{
A list containing:
\itemize{
\item lbPars: Named vector of estimated parameters including F/M, SPR,
and selectivity parameters (if estimated)
\item lbStdErrs: Standard errors for estimated parameters
\item fixedFleetPars: Original fixed fleet parameters
\item PredLen: Predicted length composition from fitted model
\item NLL: Negative log-likelihood at optimum
\item optimOut: Full output from optim() function
\item MLE: Data frame with parameter estimates, initial values, and standard errors
}
}
\description{
Main optimization function that estimates fishing mortality and optionally
selectivity parameters (only for logistic selectivity) by fitting to observed length composition data.
}
\details{
This function performs maximum likelihood estimation by:
\enumerate{
\item Setting up optimization based on selectivity type
\item Using optim() with either BFGS (multiple parameters) or Brent (F/M only)
\item Calculating standard errors using the inverse Hessian
\item Re-running the simulation with optimal parameters
\item Returning comprehensive results
}

For logistic selectivity, if only the selectivity type is specified, both
F/M and selectivity parameters (SL50, SL95) are estimated.
For dome-shaped selectivity types, only F/M is estimated with selectivity parameters fixed.
}
\examples{
\donttest{
# Optimize F/M 
# Create LifeHistory object
LifeHistoryObj <- new("LifeHistory")
LifeHistoryObj@Linf <- 120
LifeHistoryObj@K <- 0.2
LifeHistoryObj@L50 <- 60
LifeHistoryObj@L95delta <- 2
LifeHistoryObj@MK <- 1.5
LifeHistoryObj@LW_A <- 0.01
LifeHistoryObj@LW_B <- 3
LifeHistoryObj@Steep <- 0.7
LifeHistoryObj@R0 <- 1E6
attr(LifeHistoryObj, "NGTG") <- 13
attr(LifeHistoryObj, "CVLinf") <- 0.1
attr(LifeHistoryObj, "MaxSD") <- 2
 
# Fixed dome-shaped selectivity
fixedFleetPars <- list(
selectivityCurve = "Normal.sca",
SL1 = 55,
SL2 = 18,
SLmesh = c(13.5, 14.0, 14.8, 15.4, 15.9, 16.6, 17.8, 19),
   use_aggregated = TRUE
 )
 
 # Observed length composition data
 data(gtg_catch_frequency)
 LenDat <- gtg_catch_frequency$Catch_1
 
 # Run optimization
 result <- DoOptDome(LifeHistoryObj, fixedFleetPars, LenDat, 
                     SizeBins = list(Linc = 1, ToSize = 144), mod = "GTG")
 
 # Check results
 print(result$lbPars)
 }
}
\seealso{
\code{\link{GTGDomeLBSPRSim2}}, \code{\link{OptFunDome}}
}
